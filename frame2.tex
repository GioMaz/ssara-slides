% Errors

% B0:
% r0 <- 5
% if r0 < 10 then B1 else B2
%
% B1:
% r1 <- r0
%
% B2:
% r2 <- r0 + 2
%
% B3:
% r3 <- phi r1 r2
% r4 <- r0 + r3

\begin{definition}[Static Single Assignment (SSA)]
    A program is in SSA form iff:
    \begin{itemize}
        \item Every variable is defined \textit{exactly} once;
        \item For every variable, its definition comes before its usages.
    \end{itemize}
\end{definition}

\vfill

\begin{minipage}{0.48\linewidth}
\centering
\begin{tikzpicture}[
    node distance=10mm,
    every node/.style={draw, align=left, inner sep=4pt},
    >={Stealth}
]
\node (entry) at (0, 0) [draw, label=left:$B_0$] {
    $\textcolor<8->{\cbnodeA}{r_0} \leftarrow 5$ \\
    $\textcolor<9->{\cbnodeB}{r_1} \leftarrow 10$ \\
    if $\textcolor<8->{\cbnodeA}{r_0} < \textcolor<9->{\cbnodeB}{r_1}$
};
\node (b1) at (-1.7, -1.4) [draw, label=left:$B_1$] {
    $\textcolor<10->{\cbnodeC}{r_2} \leftarrow \textcolor<8->{\cbnodeA}{r_0} + 1$
};
\node (b2) at (1.7, -1.4) [draw, label=right:$B_2$] {
    $\textcolor<11->{\cbnodeC}{r_3} \leftarrow \textcolor<8->{\cbnodeA}{r_0} + 2$
};
\node (end) at (0, -2.85) [draw, label=left:$B_3$] {
    $\textcolor<12->{\cbnodeB}{r_4} \leftarrow \phi(\textcolor<10->{\cbnodeC}{r_2}, \textcolor<11->{\cbnodeC}{r_3})$ \\
    $\textcolor<13->{\cbnodeA}{r_5} \leftarrow \textcolor<8->{\cbnodeA}{r_0} + \textcolor<9->{\cbnodeB}{r_1}$ \\
    ret $\textcolor<12->{\cbnodeB}{r_4}$
};
\draw[->] (entry) -- (b1);
\draw[->] (entry) -- (b2);
\draw[->] (b1) -- (end);
\draw[->] (b2) -- (end);
\end{tikzpicture}

\end{minipage}
\hfill
\begin{minipage}{0.48\linewidth}
\begin{center}
\begin{tikzpicture}[scale=1, every node/.style={circle, draw, minimum size=8mm}]
\node<-6> (r0) at (0,0) {$r_0$};
\node<-5> (r1) at (2,-2) {$r_1$};
\node<-3> (r2) at (0,-2) {$r_2$};
\node<-4> (r3) at (2,0) {$r_3$};
\node<-2> (r4) at (-2,0) {$r_4$};
\node<-1> (r5) at (-2,-2) {$r_5$};

\node<7-7>[draw=lightgray, text=lightgray] (r0) at (0,0) {$r_0$};
\node<6-8>[draw=lightgray, text=lightgray] (r1) at (2,-2) {$r_1$};
\node<4-10>[draw=lightgray, text=lightgray] (r2) at (0,-2) {$r_2$};
\node<5-9>[draw=lightgray, text=lightgray] (r3) at (2,0) {$r_3$};
\node<3-11>[draw=lightgray, text=lightgray] (r4) at (-2,0) {$r_4$};
\node<2-12>[draw=lightgray, text=lightgray] (r5) at (-2,-2) {$r_5$};

\node<8->[fill=\cbnodeA!60] (r0) at (0,0) {$r_0$};
\node<9->[fill=\cbnodeB!60] (r1) at (2,-2) {$r_1$};
\node<11->[fill=\cbnodeC!60] (r2) at (0,-2) {$r_2$};
\node<10->[fill=\cbnodeC!60] (r3) at (2,0) {$r_3$};
\node<12->[fill=\cbnodeB!60] (r4) at (-2,0) {$r_4$};
\node<13->[fill=\cbnodeA!60] (r5) at (-2,-2) {$r_5$};

\draw<-5,9-> (r0) -- (r1);
\draw<-3,11-> (r0) -- (r2);
\draw<-4,10-> (r0) -- (r3);
\draw<-2,12-> (r0) -- (r4);
\draw<-3,11-> (r1) -- (r2);
\draw<-4,10-> (r1) -- (r3);
\draw<-2,12-> (r1) -- (r4);
\draw<-1,13-> (r4) -- (r5);
\draw<6-8>[draw=lightgray] (r0) -- (r1);
\draw<4-10>[draw=lightgray] (r0) -- (r2);
\draw<5-9>[draw=lightgray] (r0) -- (r3);
\draw<3-11>[draw=lightgray] (r0) -- (r4);
\draw<4-10>[draw=lightgray] (r1) -- (r2);
\draw<5-9>[draw=lightgray] (r1) -- (r3);
\draw<3-11>[draw=lightgray] (r1) -- (r4);
\draw<2-12>[draw=lightgray] (r4) -- (r5);
\end{tikzpicture}
\end{center}

\centering
\only<1>    {PEO:}
\only<2>    {PEO: $r_5$}
\only<3>    {PEO: $r_5, r_4$}
\only<4>    {PEO: $r_5, r_4, r_2$}
\only<5>    {PEO: $r_5, r_4, r_2, r_3$}
\only<6>    {PEO: $r_5, r_4, r_2, r_3, r_1$}
\only<7>    {PEO: $r_5, r_4, r_2, r_3, r_1, r_0$}
\only<8>    {PEO: $r_5, r_4, r_2, r_3, r_1 \textcolor{lightgray}{, r_0}$}
\only<9>    {PEO: $r_5, r_4, r_2, r_3 \textcolor{lightgray}{, r_1, r_0}$}
\only<10>   {PEO: $r_5, r_4, r_2 \textcolor{lightgray}{, r_3, r_1, r_0}$}
\only<11>   {PEO: $r_5, r_4 \textcolor{lightgray}{, r_2, r_3, r_1, r_0}$}
\only<12>   {PEO: $r_5 \textcolor{lightgray}{, r_4, r_2, r_3, r_1, r_0}$}
\only<13>   {PEO: $\textcolor{lightgray}{r_5, r_4, r_2, r_3, r_1, r_0}$}

\end{minipage}